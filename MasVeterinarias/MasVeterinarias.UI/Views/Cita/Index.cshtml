@model IEnumerable<MasVeterinarias.UI.Models.Cita>

@{
    ViewData["Title"] = "Index";
    Layout = "_LayoutV";
}

<head>
    <meta charset='utf-8' />
    <link href='~/css/main.css' rel='stylesheet' />
    <script src='~/js/main.js'></script>
    <script>

        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('calendar');

            var calendar = new FullCalendar.Calendar(calendarEl, {

                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'listDay,listWeek,listMonth'
                },

                // customize the button names,
                // otherwise they'd all just say "list"
                views: {
                    listDay: { buttonText: 'lista diaria' },
                    listWeek: { buttonText: 'lista Semanal' },
                    listMonth: { buttonText: 'lista Mensual' }
                },

                initialView: 'listMonth',
                navLinks: true, // can click day/week names to navigate views
                editable: true,
                dayMaxEvents: true,
                // allow "more" link when too many events
                eventClick: function (info) {                   
                    console.log(info);
                    console.log(info.event.id);
                    console.log(info.event.title);
                    console.log(info.event.extendedProps.ClienteId);
                    console.log(info.event.extendedProps.NombreMascota);                    
                    console.log(info.event.start);
                    console.log(info.event.end);
                    console.log(info.event.extendedProps.status);

                    $('#txtId').val(info.event.id);
                    $('#txtClient').val(info.event.extendedProps.ClienteId);
                    $('#txtPet').val(info.event.extendedProps.NombreMascota);
                    $('#txtService').val(info.event.title);

                    mes = (info.event.start.getMonth() + 1);
                    dia = (info.event.start.getDate());
                    anio = (info.event.start.getFullYear());
                    mes = (mes < 10) ? "0" + mes : mes;
                    dia = (dia < 10) ? "0" + dia : dia;
                   

                    minutos = info.event.start.getMinutes(); 
                    hora = info.event.start.getHours();

                    minutos = (minutos < 10) ? "0" + minutos : minutos;
                    hora = (hora < 10) ? "0" + hora : hora;

                    horario = (hora+ ":" +minutos );

                    $('#txtFecha').val(anio+"-"+mes+"-"+dia);
                    $('#txtHora').val(horario);
                    $('#exampleModal').modal();
                },

                events: [
                    {
                        id: 1,
                        title: 'Baño Perro Grande',
                        ClienteId: 'Gabriel Rojas',
                        NombreMascota: 'Firulais',
                        start: '2021-02-18T12:30:00',
                        ServicioId: 1,
                    },
                    {
                        id: 2,
                        title: 'Baño Gato',
                        ClienteId: 'Gabriel Rojas',
                        NombreMascota: 'Firulais',
                        start: '2021-02-18T14:00:00',
                        ServicioId: 1,                   },
                    {
                        id: 3,
                        title: 'Lavado de dientes Perro',
                        ClienteId: 'Gabriel Rojas',
                        NombreMascota: 'Firulais',
                        start: '2021-02-19T16:30:00',
                        ServicioId: 1,
                    },

                    {
                        id: 4,
                        title: 'Lavado de dientes Perro',
                        ClienteId: 'Jorge',
                        NombreMascota: 'Firulais',
                        start: '2021-02-20T08:00:00',
                        ServicioId: 1,
                    },
                    {
                        id: 5,
                        title: 'Baño Perro Grande',
                        ClienteId: 'Gabriel',
                        NombreMascota: 'Firulais',
                        start: '2021-02-24T10:00:00',
                        ServicioId: 1,
                    },
                    
                ]

              

            });

            calendar.setOption('locale', 'Es');
            calendar.render();

            $('#btnEdit').click(function(){
                
            });

            function GetDataUI(method)
            {

                NewEven = {
                    id: $('#txtId').val(),
                    ClienteId: $('#txtClient').val(),
                    NombreMascota: $('#txtPet').val(),
                    Hora: $('#txtStart').val(),
                    start: $('#txtFecha').val(),
                    ServicioId: $('#txtService').val(),
                    '_method': method
                }
                return(NewEven);

            }

        });

    </script>
    <style>

        body {
            margin: 100px 0px;
            padding: 0px;
            font-family: Arial, Helvetica Neue, Helvetica, sans-serif;
            font-size: 14px;
           
        }

        #calendar {
            max-width: 1100px;
            margin: 0 auto;
            
        }
    </style>
</head>

<body>
    <div id='calendar'></div>
    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Datos de la cita</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="d-none">
                        Id:
                        <input type="text" name="txtId" id="txtId">
                        <br />
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group col-md-8">
                            <label>Cliente:</label>  
                            <input readonly type="text" class="form-control" name="txtClient" id="txtClient">
                        </div>
                        <div class="form-group col-md-4">
                            <label>Mascota:</label>
                            <input readonly type="text" class="form-control" name="txtPet" id="txtPet">
                        </div>
                        <div class="form-group col-md-12">
                            <label>Servicio:</label>
                            <input readonly type="text" class="form-control" name="txtService" id="txtService">
                        </div>
                        <div class="form-group col-md-8">
                            <label>Fecha:</label>
                            <input readonly type="text" class="form-control" name="txtFecha" id="txtFecha">
                        </div>
                        <div class="form-group col-md-4">
                            <label>Hora:</label>
                            <input readonly type="time" class="form-control" name="txtHora" id="txtHora">
                        </div>
                        <div class="d-none">
                            <div class="form-group col-md-12">
                                <label>Status:</label>
                                <input type="text" class="form-control" name="txtStatus" id="txtStatus">
                            </div>

                        </div>
                        
                    </div> 

                    
                </div>
                <div class="modal-footer">
                    <button id="btnEdit" class="btn btn-primary">Aceptar</button>
                    <button id="btnDelete"class="btn btn-danger">Rechazar</button>
                </div>
            </div>
        </div>
    </div>
</body>



